---
name: gymiq-development-flow
description: "Mandatory development workflow for GymIQ. Enforces understanding before coding, impact analysis, and systematic bug prevention. Use BEFORE writing any code - this is the missing link between project-control and qa-testing."
---

# GymIQ Development Flow

**מתי להפעיל:** לפני כל שינוי קוד - זה ה-Skill שמונע תקלות!

## 🚦 תהליך חובה לפני כל שינוי

```
┌─────────────────────────────────────────────────────────────┐
│  משימה → הבנה → תכנון → קוד → בדיקה → commit               │
│           ↑                                                 │
│      אתה כאן                                                │
└─────────────────────────────────────────────────────────────┘
```

---

## שלב 1: הבנת המצב הקיים (חובה!)

### 1.1 מיפוי תלויות
```bash
# מצא מה תלוי בקוד שאתה משנה:
grep -r "FunctionOrComponentName" src/ --include="*.tsx" --include="*.ts"

# דוגמה - אם משנים addExercise:
grep -r "addExercise(" src/ | grep -v "removeExercise"
```

**רשום את התוצאה:**
```
קבצים שמשתמשים בקוד הזה:
1. _______________
2. _______________
3. _______________
```

### 1.2 הבנת הזרימה
```
מאיפה מגיעים לקוד הזה?
User action: _______ → Component: _______ → Function: _______

לאן הנתונים הולכים אחרי?
Function → Store/State: _______ → UI Component: _______
```

### 1.3 בדיקת אזורים רגישים
```bash
# האם אתה נוגע באחד מאלה? (אם כן - זהירות כפולה!)
□ addExercise / removeExercise
□ WorkoutHistory / WorkoutSession
□ calories / estimateCalories
□ workout status (completed/cancelled/in_progress)
□ category / primaryMuscle
```

---

## שלב 2: ניתוח השפעות (Impact Analysis)

### 2.1 מה יכול להישבר?

| אזור | סיכון | בדיקה נדרשת |
|------|-------|-------------|
| זרימת אימון | גבוה | התחל→סיים אימון מלא |
| שמירת נתונים | גבוה | בדוק ב-Firebase שנשמר |
| תצוגת היסטוריה | בינוני | calories, סטים מוצגים נכון |
| UI/RTL | בינוני | בדוק ב-375px |

### 2.2 רשימת בדיקות שאעשה אחרי השינוי
```
□ _________________________________
□ _________________________________
□ _________________________________
```

---

## שלב 3: תכנון השינוי

### 3.1 מה בדיוק אני משנה?
```
קובץ: _______________
פונקציה/רכיב: _______________
שינוי: _______________
```

### 3.2 מה אני לא משנה (גבולות!)
```
❌ לא נוגע ב: _______________
❌ לא מוחק: _______________
❌ לא מוסיף פיצ'רים שלא ביקשו: _______________
```

### 3.3 שינוי מינימלי
> **כלל זהב:** השינוי הקטן ביותר שפותר את הבעיה

---

## שלב 4: קוד + בדיקה מיידית

### 4.1 בזמן הקוד
```
□ שינוי קטן אחד בכל פעם
□ בדיקה מיידית אחרי כל שינוי
□ לא "לנקות" קוד שלא קשור למשימה
```

### 4.2 אחרי כל שינוי
```bash
# בדיקה מהירה:
npm run build 2>&1 | grep -i error
npm run lint 2>&1 | head -20
```

---

## שלב 5: Self-Review לפני Commit

### 5.1 בדיקת רגרסיות קריטיות
```bash
# הרץ תמיד לפני commit:
echo "=== Regression Check ===" && \
grep -r "WorkoutSummaryModal" src/ | wc -l && \
grep -r "handleDeleteWorkout" src/ | wc -l && \
grep -r "workout\.calories" src/ | wc -l && \
grep -r "handleAddSet" src/ | wc -l && \
echo "All counts should be > 0"
```

### 5.2 בדיקת אבטחה
```bash
# ודא שאין מפתחות בקוד:
grep -r "AIza" --include="*.ts" --include="*.tsx" . | grep -v node_modules
# אמור להיות ריק!
```

### 5.3 Checklist סופי
```
□ build עובר בלי שגיאות
□ lint עובר בלי שגיאות
□ בדקתי ב-375px (מובייל)
□ בדקתי זרימה מלאה (לא רק את הפיצ'ר הספציפי)
□ רגרסיות קריטיות קיימות (grep למעלה)
□ אין מפתחות בקוד
```

---

## 🔴 חקירת באגים - תהליך מובנה

### שלב א: הבנת הבעיה
```
מה המשתמש דיווח: _______________
מה היה צריך לקרות: _______________
מה קרה בפועל: _______________
```

### שלב ב: שחזור
```
Steps to reproduce:
1. _______________
2. _______________
3. _______________
Result: _______________
```

### שלב ג: מיפוי הזרימה הבעייתית
```
User action → Component → Function → State → Result
    ↓            ↓           ↓         ↓        ↓
  _____       _____       _____     _____    _____
```

### שלב ד: זיהוי נקודת הכשל
```bash
# חפש בקוד:
grep -r "relevantFunction" src/
grep -r "relevantState" src/

# בדוק בקונסול:
# הוסף console.log זמני לזרימה
# עקוב אחרי הנתונים
```

### שלב ה: תיקון ממוקד
```
□ תקן רק את הבעיה - לא "לנקות" סביב
□ בדוק שהתיקון עובד
□ בדוק שלא שברת משהו אחר
□ הסר console.log זמניים
```

### שלב ו: מניעת חזרה
```
□ הוסף בדיקה ל-qa-testing-SKILL.md אם רלוונטי
□ תעד את הבאג ב-CHANGELOG
```

---

## 📋 תבנית דיווח מהיר

```
🎯 משימה: [תיאור קצר]

📖 הבנה:
- קוד רלוונטי: [קבצים]
- תלויות: [מה תלוי בזה]
- אזורים רגישים: [כן/לא - אילו]

📐 תכנון:
- שינוי: [מה בדיוק]
- לא נוגע ב: [גבולות]

✅ בדיקות שבוצעו:
- [ ] build
- [ ] lint
- [ ] 375px
- [ ] זרימה מלאה
- [ ] regression grep

🔐 אבטחה: תקין / נמצאו בעיות
```

---

## 🔗 קישור ל-Skills אחרים

| אחרי שלב | עבור ל-Skill |
|----------|--------------|
| הבנת משימה | project-control-SKILL.md |
| עבודה עם נתונים | firebase-data-SKILL.md |
| שינוי UI | mobile-rtl-SKILL.md |
| סיום ובדיקות | qa-testing-SKILL.md |
| לפני deploy | deployment-SKILL.md |

---

```
══════════════════════════════════════════════════════════════
נוצר: 26/01/2026 | מטרה: מניעת תקלות על ידי הבנה לפני פעולה
══════════════════════════════════════════════════════════════
```
