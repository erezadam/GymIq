```
קרא את קובץ CLAUDE.md בתיקיית הפרויקט והצהר שקראת אותו לפני שתתחיל לעבוד.

משימה: תחקיר כשל + תיקון + עדכון פרוטוקולים

---

רקע:

בפיצ'ר האחרון (המלצות משקל) יצרת subcollection חדש: exerciseRecommendations.
דיווחת שהכל עובר - Build, Security, Regression.
בפועל - הכתיבה ל-Firestore נכשלת. המשתמש גילה את זה, לא אתה.

זה לא הפעם הראשונה שזה קורה. זו בעיה חוזרת.

---

שלב 1: תחקיר - מה קרה

ענה על השאלות הבאות בכנות ובפירוט:

1. האם עדכנת את firestore.rules עם הרשאות ל-exerciseRecommendations?
2. אם כן - האם עשית firebase deploy --only firestore:rules?
3. האם בדקת שהכתיבה ל-Firestore מצליחה בפועל (לא רק שה-build עובר)?
4. האם בדקת שהקריאה מ-Firestore מחזירה נתונים?
5. מה בדיוק בדקת כשדיווחת "Security: בדיקת סדורה - תקין"?
6. מה בדיוק בדקת כשדיווחת "Regression: כל הבדיקות עוברות"?

אל תצדיק, אל תסביר למה. רק תגיד מה עשית ומה לא עשית.

---

שלב 2: תיקון מיידי

1. בדוק את firestore.rules - האם יש הרשאה ל-users/{userId}/exerciseRecommendations?
2. אם חסר - הוסף הרשאות (read + write לבעל המסמך בלבד)
3. בצע firebase deploy --only firestore:rules
4. בדוק בפועל:
   - סיים אימון עצמאי עם תרגיל משקל
   - פתח Firebase Console ובדוק שהמסמך exerciseRecommendations נוצר עם נתונים
   - פתח אימון חדש ובדוק שההמלצה הסגולה מופיעה (אם התנאי מתקיים)
5. דווח תוצאות עם צילומי מסך או לוגים

---

שלב 3: עדכון פרוטוקולים למניעת חזרה

בדוק אילו קבצי פרוטוקול קיימים בפרויקט (CLAUDE.md, qa_scenarios.md, architecture.md וכד') והמלץ היכן להוסיף את הכללים הבאים:

כלל 1 - Firestore Subcollection Checklist:
כל פעם שנוצר collection או subcollection חדש ב-Firestore חובה:
  א. לעדכן firestore.rules עם הרשאות
  ב. לבצע firebase deploy --only firestore:rules
  ג. לבדוק כתיבה בפועל (לא רק build)
  ד. לבדוק קריאה בפועל
  ה. לוודא שהמסמך נוצר ב-Firebase Console

כלל 2 - הגדרה מחודשת של "בדיקה עוברת":
  - Build עובר = קוד מתקמפל. זה לא אומר שהפיצ'ר עובד.
  - בדיקה עוברת = הנתון נכתב ל-Firestore + נקרא בהצלחה + מוצג למשתמש.
  - Security תקין = הרשאות נבדקו בפועל, לא רק שהקובץ קיים.

אל תוסיף את הכללים בעצמך. רק המלץ לאיזה קובץ ואיזה סעיף, ותן לי לאשר לפני שתשנה.

---

פורמט הדיווח:

1. תחקיר: מה עשיתי / מה לא עשיתי (טבלה)
2. תיקון: מה שיניתי + הוכחה שעובד
3. המלצות: איזה קבצים לעדכן + הנוסח המוצע
```
