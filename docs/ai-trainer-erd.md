# ERD - ××××Ÿ AI (××¡××š ×ª×›× ×•×Ÿ)

## ×¡×§×™×¨×” ×›×œ×œ×™×ª

××¡××š ×–×” ××ª××¨ ××ª ××‘× ×” ×”× ×ª×•× ×™× ×¢×‘×•×¨ ×¤×™×¦'×¨ ××××Ÿ AI ×©×™×™×™×¦×¨ ××™××•× ×™× ××•×ª×××™× ××™×©×™×ª.

---

## 1. ×“×™××’×¨××ª ×™×©×•×™×•×ª ×•×§×©×¨×™×

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              FIREBASE COLLECTIONS                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     users        â”‚         â”‚    exercises     â”‚         â”‚     muscles      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ uid (PK)         â”‚         â”‚ id (PK)          â”‚         â”‚ id (PK)          â”‚
â”‚ name             â”‚         â”‚ name             â”‚         â”‚ nameHe           â”‚
â”‚ phone            â”‚         â”‚ nameHe           â”‚         â”‚ nameEn           â”‚
â”‚ role             â”‚         â”‚ category         â”‚         â”‚ icon             â”‚
â”‚ createdAt        â”‚         â”‚ primaryMuscle â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ subMuscles[]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ secondaryMuscles â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                   â”‚ equipment â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”
         â”‚                   â”‚ imageUrl         â”‚      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                   â”‚ reportType       â”‚      â”‚  â”‚    equipment     â”‚
         â”‚                   â”‚ isCardio         â”‚      â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚                   â”‚ caloriesPerMinuteâ”‚      â””â”€>â”‚ id (PK)          â”‚
         â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ nameHe           â”‚
         â”‚                                                â”‚ nameEn           â”‚
         â”‚                                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1:N
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              workoutHistory                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)                                                                          â”‚
â”‚ odcId (index)                                                                    â”‚
â”‚ userId (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> users.uid                                â”‚
â”‚ status: 'planned' | 'in_progress' | 'completed' | 'cancelled'                    â”‚
â”‚ exercises[]                                                                      â”‚
â”‚ workoutDate                                                                      â”‚
â”‚ startTime                                                                        â”‚
â”‚ endTime                                                                          â”‚
â”‚ duration                                                                         â”‚
â”‚ totalVolume                                                                      â”‚
â”‚ calories                                                                         â”‚
â”‚ muscleGroups[]                                                                   â”‚
â”‚ createdAt                                                                        â”‚
â”‚ updatedAt                                                                        â”‚
â”‚                                                                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ ** ×©×“×•×ª ×—×“×©×™× ×œ××××Ÿ AI **                                                  â”‚  â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚ â”‚ source: 'manual' | 'ai_trainer'          // ××§×•×¨ ×”××™××•×Ÿ                    â”‚  â”‚
â”‚ â”‚ aiWorkoutNumber?: number                  // ××¡×¤×¨ ××™××•×Ÿ ××××Ÿ (1, 2, 3...)   â”‚  â”‚
â”‚ â”‚ aiGeneratedAt?: Timestamp                 // ×–××Ÿ ×™×¦×™×¨×” ×¢"×™ AI               â”‚  â”‚
â”‚ â”‚ aiPromptSummary?: string                  // ×ª×§×¦×™×¨ ×”×‘×§×©×”                   â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1:N (embedded)
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         exercises[] (Embedded Array)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ exerciseId (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> exercises.id                             â”‚
â”‚ exerciseName                                                                     â”‚
â”‚ exerciseNameHe                                                                   â”‚
â”‚ order                                                                            â”‚
â”‚ sets[]                                                                           â”‚
â”‚   â”œâ”€â”€ setNumber                                                                  â”‚
â”‚   â”œâ”€â”€ weight                                                                     â”‚
â”‚   â”œâ”€â”€ reps                                                                       â”‚
â”‚   â”œâ”€â”€ time                                                                       â”‚
â”‚   â””â”€â”€ completed                                                                  â”‚
â”‚ notes                                                                            â”‚
â”‚ reportType                                                                       â”‚
â”‚                                                                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ ** ×©×“×•×ª ×—×“×©×™× ×œ××××Ÿ AI **                                                  â”‚  â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚ â”‚ isWarmup?: boolean                        // ×ª×¨×’×™×œ ×—×™××•×                    â”‚  â”‚
â”‚ â”‚ targetSets?: number                       // ××¡×¤×¨ ×¡×˜×™× ××•××œ×¥               â”‚  â”‚
â”‚ â”‚ targetReps?: string                       // ×˜×•×•×— ×—×–×¨×•×ª ××•××œ×¥ ("8-12")      â”‚  â”‚
â”‚ â”‚ aiNotes?: string                          // ×”×¢×¨×•×ª ×-AI                     â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ×™×©×•×™×•×ª ×—×“×©×•×ª ×œ××××Ÿ AI

### 2.1 aiTrainerSessions (××•×¤×¦×™×•× ×œ×™ - ×œ×©××™×¨×ª ×”×™×¡×˜×•×¨×™×™×ª ×©×™×—×•×ª)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         aiTrainerSessions (××•×¤×¦×™×•× ×œ×™)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)                                                                          â”‚
â”‚ odcId (index)                                                                    â”‚
â”‚ userId (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> users.uid                                â”‚
â”‚ createdAt                                                                        â”‚
â”‚ status: 'active' | 'completed' | 'cancelled'                                     â”‚
â”‚                                                                                  â”‚
â”‚ userPreferences: {                                                               â”‚
â”‚   targetDuration: number              // ××©×š ××™××•×Ÿ ×¨×¦×•×™ (×“×§×•×ª)                  â”‚
â”‚   targetMuscleGroups?: string[]       // ×©×¨×™×¨×™× ××‘×•×§×©×™×                         â”‚
â”‚   excludedExercises?: string[]        // ×ª×¨×’×™×œ×™× ×œ× ×¨×¦×•×™×™×                      â”‚
â”‚   warmupDuration?: number             // ××©×š ×—×™××•× (×“×§×•×ª)                       â”‚
â”‚ }                                                                                â”‚
â”‚                                                                                  â”‚
â”‚ contextData: {                                                                   â”‚
â”‚   recentWorkouts: WorkoutSummary[]    // 3-5 ××™××•× ×™× ××—×¨×•× ×™×                    â”‚
â”‚   availableExercises: string[]        // IDs ×ª×¨×’×™×œ×™× ×–××™× ×™×                     â”‚
â”‚   muscleLoadHistory: MuscleLoad[]     // ×¢×•××¡ ×©×¨×™×¨×™× ××—×¨×•×Ÿ                      â”‚
â”‚ }                                                                                â”‚
â”‚                                                                                  â”‚
â”‚ generatedWorkoutId?: string (FK) â”€â”€â”€â”€â”€> workoutHistory.id                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 aiTrainerConfig (×”×’×“×¨×•×ª ×’×œ×•×‘×œ×™×•×ª)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              aiTrainerConfig                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id: 'default' (singleton)                                                        â”‚
â”‚                                                                                  â”‚
â”‚ enabled: boolean                       // ×¤×™×¦'×¨ ×¤×¢×™×œ                            â”‚
â”‚ fallbackEnabled: boolean               // Fallback ×›×©××™×Ÿ Claude                 â”‚
â”‚                                                                                  â”‚
â”‚ defaults: {                                                                      â”‚
â”‚   minExercises: 6                      // ××™× ×™××•× ×ª×¨×’×™×œ×™×                       â”‚
â”‚   maxExercises: 12                     // ××§×¡×™××•× ×ª×¨×’×™×œ×™×                       â”‚
â”‚   exerciseDurationMinutes: 6           // ×–××Ÿ ×××•×¦×¢ ×œ×ª×¨×’×™×œ                      â”‚
â”‚   warmupExerciseCount: 1               // ××¡×¤×¨ ×ª×¨×’×™×œ×™ ×—×™××•×                     â”‚
â”‚   restBetweenExercises: 60-90          // ×× ×•×—×” ×‘×™×Ÿ ×ª×¨×’×™×œ×™× (×©× ×™×•×ª)            â”‚
â”‚ }                                                                                â”‚
â”‚                                                                                  â”‚
â”‚ muscleRotation: {                                                                â”‚
â”‚   minDaysBetweenSameMuscle: 2          // ××™× ×™××•× ×™××™× ×‘×™×Ÿ ××•×ª×• ×©×¨×™×¨            â”‚
â”‚   avoidYesterdayExercises: true        // ×œ× ×œ×—×–×•×¨ ×¢×œ ×ª×¨×’×™×œ×™ ××ª××•×œ              â”‚
â”‚ }                                                                                â”‚
â”‚                                                                                  â”‚
â”‚ promptTemplate: string                 // Template ×œ-Claude                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. ×§×©×¨×™× ×‘×™×Ÿ ×™×©×•×™×•×ª

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              RELATIONSHIPS                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

users (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> (N) workoutHistory
  â”‚                                          â”‚
  â”‚                                          â”‚ source = 'ai_trainer'
  â”‚                                          â–¼
  â”‚                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                    â”‚ AI Generated    â”‚
  â”‚                                    â”‚ Workouts        â”‚
  â”‚                                    â”‚ (×ª×•×•×™×ª "××××Ÿ")  â”‚
  â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> (N) aiTrainerSessions (××•×¤×¦×™×•× ×œ×™)
                                             â”‚
                                             â”‚ generatedWorkoutId
                                             â–¼
                                       workoutHistory


exercises (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> (N) workoutHistory.exercises[]
     â”‚
     â”‚ primaryMuscle
     â–¼
muscles â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ AI Trainer Context
     â”‚                                        (×©×¨×™×¨×™× ×–××™× ×™×)
     â”‚
     â–¼
equipment â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ AI Trainer Context
                                             (×¦×™×•×“ ×–××™×Ÿ - ×›×œ ×”×¦×™×•×“)
```

---

## 4. ×–×¨×™××ª × ×ª×•× ×™× - ××××Ÿ AI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DATA FLOW - AI TRAINER                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

×©×œ×‘ 1: ××™×¡×•×£ ×§×•× ×˜×§×¡×˜
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   Firebase   â”‚      â”‚   Firebase   â”‚      â”‚   Firebase   â”‚
   â”‚  exercises   â”‚      â”‚   muscles    â”‚      â”‚workoutHistoryâ”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                     â”‚                     â”‚
          â”‚ ×›×œ ×”×ª×¨×’×™×œ×™×        â”‚ ×›×œ ×”×©×¨×™×¨×™×          â”‚ 3-5 ××™××•× ×™× ××—×¨×•× ×™×
          â”‚ (×œ× cardio)        â”‚                     â”‚ + ××™××•×Ÿ ××ª××•×œ
          â–¼                     â–¼                     â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                    Context Builder                        â”‚
   â”‚  - ×ª×¨×’×™×œ×™× ×–××™× ×™× (×œ×¤×™ ×¦×™×•×“)                             â”‚
   â”‚  - ×©×¨×™×¨×™× ×•×©×¨×™×¨×™× ××©× ×™×™×                                  â”‚
   â”‚  - ×”×™×¡×˜×•×¨×™×™×ª ××™××•× ×™× ××—×¨×•× ×”                               â”‚
   â”‚  - ×ª×¨×’×™×œ×™× ×©× ×¢×©×• ××ª××•×œ (×œ× ×œ×—×–×•×¨)                         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼

×©×œ×‘ 2: ×‘×—×™×¨×ª ××©×ª××©
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                    User Input Screen                      â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
   â”‚  â”‚ ××©×š ××™××•×Ÿ:  [30] [45] [60] [75] ×“×§×•×ª â”‚                 â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
   â”‚                                                          â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
   â”‚  â”‚ ×—×™××•×:      [5] [10] [15] ×“×§×•×ª      â”‚                 â”‚
   â”‚  â”‚             (×ª×¨×’×™×œ ×§×¨×“×™×•)           â”‚                 â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
   â”‚                                                          â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
   â”‚  â”‚ ×§×‘×•×¦×•×ª ×©×¨×™×¨×™×: [×‘×—×¨] (××•×¤×¦×™×•× ×œ×™)    â”‚                 â”‚
   â”‚  â”‚ (×-Firebase muscles)                â”‚                 â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
   â”‚                                                          â”‚
   â”‚         [ğŸ¤– ×¦×•×¨ ××™××•×Ÿ]                                   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼

×©×œ×‘ 3: ×™×¦×™×¨×ª ××™××•×Ÿ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                   Claude API / Fallback                   â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚                                                          â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
   â”‚  â”‚   Claude API    â”‚ OR  â”‚ Fallback Logic  â”‚            â”‚
   â”‚  â”‚   (Tool Use)    â”‚     â”‚ (Predefined)    â”‚            â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
   â”‚           â”‚                       â”‚                      â”‚
   â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
   â”‚                       â–¼                                  â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
   â”‚  â”‚ Generated Workout:                          â”‚        â”‚
   â”‚  â”‚ - warmupExercise (cardio)                   â”‚        â”‚
   â”‚  â”‚ - exercises[] (6-10 based on duration)      â”‚        â”‚
   â”‚  â”‚ - targetSets, targetReps per exercise       â”‚        â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼

×©×œ×‘ 4: ×©××™×¨×” ×œ-Firebase
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                   workoutHistory                          â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚  {                                                       â”‚
   â”‚    id: "auto-generated",                                 â”‚
   â”‚    odcId: "user123",                                     â”‚
   â”‚    userId: "user123",                                    â”‚
   â”‚    status: "planned",        // ××ª×•×›× ×Ÿ                   â”‚
   â”‚    source: "ai_trainer",     // *** ×—×“×© ***              â”‚
   â”‚    aiWorkoutNumber: 5,       // *** ×—×“×© ***              â”‚
   â”‚    aiGeneratedAt: Timestamp, // *** ×—×“×© ***              â”‚
   â”‚    workoutDate: "2026-01-20",                            â”‚
   â”‚    exercises: [                                          â”‚
   â”‚      {                                                   â”‚
   â”‚        exerciseId: "cardio1",                            â”‚
   â”‚        isWarmup: true,       // *** ×—×“×© ***              â”‚
   â”‚        targetSets: 1,        // *** ×—×“×© ***              â”‚
   â”‚        ...                                               â”‚
   â”‚      },                                                  â”‚
   â”‚      {                                                   â”‚
   â”‚        exerciseId: "ex123",                              â”‚
   â”‚        targetSets: 3,        // *** ×—×“×© ***              â”‚
   â”‚        targetReps: "8-12",   // *** ×—×“×© ***              â”‚
   â”‚        aiNotes: "...",       // *** ×—×“×© ***              â”‚
   â”‚        ...                                               â”‚
   â”‚      }                                                   â”‚
   â”‚    ]                                                     â”‚
   â”‚  }                                                       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼

×©×œ×‘ 5: ×”×¦×’×” ×œ××©×ª××©
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚              WorkoutHistory Screen (×§×™×™×)                 â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚                                                          â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
   â”‚  â”‚ ğŸ“… 20/01/2026                               â”‚        â”‚
   â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚        â”‚
   â”‚  â”‚ â”‚ ğŸ¤– ××××Ÿ #5              [××ª×•×›× ×Ÿ]        â”‚ â”‚        â”‚
   â”‚  â”‚ â”‚ ×—×–×”, ×›×ª×¤×™×™×, ×˜×¨×™×™×¡×¤×¡                    â”‚ â”‚        â”‚
   â”‚  â”‚ â”‚ 8 ×ª×¨×’×™×œ×™× | 60 ×“×§×•×ª                     â”‚ â”‚        â”‚
   â”‚  â”‚ â”‚                                         â”‚ â”‚        â”‚
   â”‚  â”‚ â”‚ [×”×ª×—×œ ××™××•×Ÿ]  [×¢×¨×•×š]  [××—×§]             â”‚ â”‚        â”‚
   â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚        â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
   â”‚                                                          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ "×”×ª×—×œ ××™××•×Ÿ"
                              â–¼

×©×œ×‘ 6: ×‘×™×¦×•×¢ ××™××•×Ÿ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚            ActiveWorkoutScreen (×§×™×™× - ×œ×œ× ×©×™× ×•×™)         â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚  - ×›×œ ×”×œ×•×’×™×§×” ×”×§×™×™××ª ×¢×•×‘×“×ª                               â”‚
   â”‚  - ××©×ª××© ×™×›×•×œ ×œ×”×•×¡×™×£/×œ××—×•×§ ×ª×¨×’×™×œ×™×                       â”‚
   â”‚  - Auto-save ×›×œ 2 ×©× ×™×•×ª                                  â”‚
   â”‚  - Rest Timer ×¢× ×¦×œ×™×œ×™×                                  â”‚
   â”‚  - ×ª×¨×’×™×œ×™× ×—×œ×•×¤×™×™× ××××’×¨ ×”×ª×¨×’×™×œ×™×                        â”‚
   â”‚                                                          â”‚
   â”‚  ×ª×¦×•×’×” × ×•×¡×¤×ª (××•×¤×¦×™×•× ×œ×™):                                â”‚
   â”‚  - ×”×¦×’×ª targetSets/targetReps ××”××œ×¦×ª AI                  â”‚
   â”‚  - ×”×¦×’×ª aiNotes ×× ×§×™×™××•×ª                                â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Fallback Logic - ERD

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           FALLBACK LOGIC DATA                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

×›×©Claude ×œ× ×–××™×Ÿ, ×”×œ×•×’×™×§×” ××©×ª××©×ª ×‘× ×ª×•× ×™× ×”×‘××™×:

Input:
â•â•â•â•â•â•â•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    exercises     â”‚     â”‚     muscles      â”‚     â”‚  workoutHistory  â”‚
â”‚   (Firebase)     â”‚     â”‚   (Firebase)     â”‚     â”‚   (last 7 days)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                        â”‚                        â”‚
         â–¼                        â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Fallback Algorithm                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  1. ×¡× ×Ÿ ×ª×¨×’×™×œ×™ ××ª××•×œ (yesterdayExerciseIds)                         â”‚
â”‚     SELECT exerciseId FROM workoutHistory                            â”‚
â”‚     WHERE workoutDate = yesterday AND userId = currentUser           â”‚
â”‚                                                                      â”‚
â”‚  2. ×§×‘×œ ×©×¨×™×¨×™× ×©× ×¢×‘×“×• ×‘-48 ×©×¢×•×ª ××—×¨×•× ×•×ª                             â”‚
â”‚     SELECT DISTINCT primaryMuscle FROM workoutHistory.exercises      â”‚
â”‚     WHERE workoutDate >= (today - 2) AND userId = currentUser        â”‚
â”‚                                                                      â”‚
â”‚  3. ×‘×—×¨ ×©×¨×™×¨×™× ×—×“×©×™× (×œ× × ×¢×‘×“×• ×œ××—×¨×•× ×”)                              â”‚
â”‚     SELECT * FROM muscles                                            â”‚
â”‚     WHERE id NOT IN (recentlyWorkedMuscles)                          â”‚
â”‚                                                                      â”‚
â”‚  4. ×‘×—×¨ ×ª×¨×’×™×œ×™× ×œ×¤×™ ×©×¨×™×¨ (2-3 ×œ×›×œ ×©×¨×™×¨)                             â”‚
â”‚     SELECT * FROM exercises                                          â”‚
â”‚     WHERE primaryMuscle = selectedMuscle                             â”‚
â”‚     AND id NOT IN (yesterdayExerciseIds)                             â”‚
â”‚     ORDER BY RANDOM()                                                â”‚
â”‚     LIMIT 3                                                          â”‚
â”‚                                                                      â”‚
â”‚  5. ×‘×—×¨ ×ª×¨×’×™×œ ×—×™××•×                                                  â”‚
â”‚     SELECT * FROM exercises                                          â”‚
â”‚     WHERE isCardio = true                                            â”‚
â”‚     ORDER BY RANDOM()                                                â”‚
â”‚     LIMIT 1                                                          â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
Output: Same as Claude output
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 6. ×¡×™×›×•× ×©×“×•×ª ×—×“×©×™×

### workoutHistory (×”×¨×—×‘×”)

| ×©×“×” | ×˜×™×¤×•×¡ | ×ª×™××•×¨ | ×‘×¨×™×¨×ª ××—×“×œ |
|-----|-------|-------|------------|
| `source` | `'manual' \| 'ai_trainer'` | ××§×•×¨ ×”××™××•×Ÿ | `'manual'` |
| `aiWorkoutNumber` | `number?` | ××¡×¤×¨ ××™××•×Ÿ ××××Ÿ | - |
| `aiGeneratedAt` | `Timestamp?` | ×–××Ÿ ×™×¦×™×¨×” ×¢"×™ AI | - |
| `aiPromptSummary` | `string?` | ×ª×§×¦×™×¨ ×”×‘×§×©×” | - |

### exercises[] (×”×¨×—×‘×”)

| ×©×“×” | ×˜×™×¤×•×¡ | ×ª×™××•×¨ | ×‘×¨×™×¨×ª ××—×“×œ |
|-----|-------|-------|------------|
| `isWarmup` | `boolean?` | ×ª×¨×’×™×œ ×—×™××•× | `false` |
| `targetSets` | `number?` | ××¡×¤×¨ ×¡×˜×™× ××•××œ×¥ | - |
| `targetReps` | `string?` | ×˜×•×•×— ×—×–×¨×•×ª ××•××œ×¥ | - |
| `aiNotes` | `string?` | ×”×¢×¨×•×ª ×-AI | - |

### exercises collection (×”×¨×—×‘×” - ×× ×œ× ×§×™×™×)

| ×©×“×” | ×˜×™×¤×•×¡ | ×ª×™××•×¨ | ×‘×¨×™×¨×ª ××—×“×œ |
|-----|-------|-------|------------|
| `isCardio` | `boolean?` | ×ª×¨×’×™×œ ×§×¨×“×™×• | `false` |
| `caloriesPerMinute` | `number?` | ×§×œ×•×¨×™×•×ª ×œ×“×§×” | - |

---

## 7. ××™× ×“×§×¡×™× ××•××œ×¦×™× (Firebase)

```javascript
// Composite indexes for workoutHistory queries

// 1. ××™××•× ×™× ××—×¨×•× ×™× ×©×œ ××©×ª××©
{
  collectionGroup: "workoutHistory",
  fields: [
    { fieldPath: "odcId", order: "ASCENDING" },
    { fieldPath: "workoutDate", order: "DESCENDING" }
  ]
}

// 2. ××™××•× ×™ AI ×©×œ ××©×ª××©
{
  collectionGroup: "workoutHistory",
  fields: [
    { fieldPath: "odcId", order: "ASCENDING" },
    { fieldPath: "source", order: "ASCENDING" },
    { fieldPath: "aiWorkoutNumber", order: "DESCENDING" }
  ]
}

// 3. ××™××•× ×™× ××ª×•×›× × ×™×
{
  collectionGroup: "workoutHistory",
  fields: [
    { fieldPath: "odcId", order: "ASCENDING" },
    { fieldPath: "status", order: "ASCENDING" },
    { fieldPath: "workoutDate", order: "ASCENDING" }
  ]
}
```

---

## 8. ×”×¢×¨×•×ª ×˜×›× ×™×•×ª

1. **Backwards Compatibility**: ×›×œ ×”×©×“×•×ª ×”×—×“×©×™× ×”× ××•×¤×¦×™×•× ×œ×™×™× - ××™××•× ×™× ×§×™×™××™× ×™××©×™×›×• ×œ×¢×‘×•×“
2. **Single Source of Truth**:
   - ×©×¨×™×¨×™× - ×¨×§ ×-Firebase `muscles`
   - ×ª×¨×’×™×œ×™× - ×¨×§ ×-Firebase `exercises`
   - ×¦×™×•×“ - ×›×œ ×”×¦×™×•×“ ×–××™×Ÿ (×—×“×¨ ×›×•×©×¨)
3. **No Weekly Limits**: ×”××©×ª××© ××—×œ×™×˜ ×¢×œ ×¢×•××¡ - ××™×Ÿ ××’×‘×œ×•×ª ×‘××¢×¨×›×ª
4. **Existing Logic**: ×›×œ ×”×œ×•×’×™×§×” ×©×œ ××™××•× ×™× ××ª×•×›× × ×™× ×¢×•×‘×“×ª ×œ×œ× ×©×™× ×•×™

---

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
××¡××š ×ª×›× ×•×Ÿ - ×œ× ×œ××™××•×©
×ª××¨×™×š: 20/01/2026
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```
